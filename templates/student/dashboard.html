{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <!-- Header Section -->
    <div class="dashboard-header mb-4 p-4 bg-primary text-white rounded-3 shadow">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h2 class="mb-2">Welcome back, {{ student[0] }}</h2>
                <div class="d-flex flex-wrap student-info">
                    <div class="me-4 mb-2">
                        <span class="fw-light">Student ID:</span>
                        <strong>{{ student[1] }}</strong>
                    </div>
                    <div class="me-4 mb-2">
                        <span class="fw-light">Email:</span>
                        <strong>{{ student[2] }}</strong>
                    </div>
                </div>
            </div>
            <div class="col-md-4 text-md-end">
                <div class="profile-icon d-inline-flex align-items-center justify-content-center bg-white text-primary rounded-circle" style="width: 80px; height: 80px;">
                    <i class="fas fa-user-graduate fs-3"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Certificates Section -->
    <div class="dashboard-section mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="mb-0"><i class="fas fa-certificate me-2"></i>Your Certificates</h3>
        </div>

        {% if certificates %}
            <div class="row g-4" id="certificatesContainer">
                {% for cert in certificates %}
                <div class="col-md-6 col-lg-4 certificate-card" data-status="{{ cert[1].lower() }}">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <span class="badge bg-{% if cert[1] == 'Approved' %}success{% elif cert[1] == 'valid' %}info{% else %}warning{% endif %}">
                                    {{ cert[1] }}
                                </span>
                                <span class="text-muted small">ID: {{ cert[0] }}</span>
                            </div>
                            <h5 class="card-title">Degree Certificate</h5>
                            <p class="card-text text-muted">
                                {% if cert[1] == 'Approved' %}
                                    Your certificate has been approved and is ready for download.
                                {% elif cert[1] == 'valid' %}
                                    Your certificate is valid and recognized by the institution.
                                {% else %}
                                    Your certificate is currently being processed.
                                {% endif %}
                            </p>
                        </div>
                        <div class="card-footer bg-transparent border-top-0">
                            {% if cert[1] == 'Approved' %}
                                <a href="{{ url_for('student.download_certificate', degree_id=cert[0]) }}" 
                                   class="btn btn-primary btn-sm w-100 download-btn">
                                    <i class="fas fa-download me-2"></i>Download PDF
                                </a>
                            {% else %}
                                <button class="btn btn-outline-secondary btn-sm w-100" disabled>
                                    {% if cert[1] == 'valid' %}
                                        <i class="fas fa-check-circle me-2"></i>Valid Certificate
                                    {% else %}
                                        <i class="fas fa-clock me-2"></i>Processing
                                    {% endif %}
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state text-center py-5 bg-light rounded-3">
                <i class="fas fa-certificate fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No Certificates Found</h4>
                <p class="text-muted">You don't have any certificates yet.</p>
            </div>
        {% endif %}
    </div>

    <!-- Dynamic Information Section -->
    <div class="info-section mb-5">
        <div class="row g-4">
            <div class="col-md-4">
                <div class="info-card h-100 p-4 rounded-3 shadow-sm border-start border-4 border-primary">
                    <div class="d-flex align-items-start mb-3">
                        <div class="info-icon bg-primary bg-opacity-10 text-primary rounded-circle me-3">
                            <i class="fas fa-award"></i>
                        </div>
                        <div>
                            <h5 class="mb-1">Academic Achievements</h5>
                            <p class="text-muted mb-0">Track and manage all your academic credentials in one secure platform.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-card h-100 p-4 rounded-3 shadow-sm border-start border-4 border-success">
                    <div class="d-flex align-items-start mb-3">
                        <div class="info-icon bg-success bg-opacity-10 text-success rounded-circle me-3">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div>
                            <h5 class="mb-1">Digital Documents</h5>
                            <p class="text-muted mb-0">Access your official documents anytime, anywhere in digital format.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-card h-100 p-4 rounded-3 shadow-sm border-start border-4 border-info">
                    <div class="d-flex align-items-start mb-3">
                        <div class="info-icon bg-info bg-opacity-10 text-info rounded-circle me-3">
                            <i class="fas fa-university"></i>
                        </div>
                        <div>
                            <h5 class="mb-1">Institution Portal</h5>
                            <p class="text-muted mb-0">Connected with your institution for seamless credential management.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Download Confirmation Modal -->
<div class="modal fade" id="downloadModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Download Certificate</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>You are about to download your degree certificate. Please ensure you have a PDF reader installed.</p>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>This is an official document. Keep it secure.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <a id="confirmDownload" href="#" class="btn btn-primary">Download Now</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const downloadButtons = document.querySelectorAll('.download-btn');
    const confirmDownload = document.getElementById('confirmDownload');
    const downloadModal = new bootstrap.Modal(document.getElementById('downloadModal'));

    downloadButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            confirmDownload.href = this.href;
            downloadModal.show();
        });
    });

    const certificateCards = document.querySelectorAll('.certificate-card');
    certificateCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.querySelector('.card').classList.add('shadow');
        });
        card.addEventListener('mouseleave', function() {
            this.querySelector('.card').classList.remove('shadow');
        });
    });

    // Add animation to info cards
    document.querySelectorAll('.info-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
            this.style.boxShadow = '0 10px 20px rgba(0,0,0,0.1)';
        });
        card.addEventListener('mouseleave', function() {
            this.style.transform = '';
            this.style.boxShadow = '';
        });
    });
});
</script>
{% endblock %}

{% block styles %}
<style>
.dashboard-header {
    background: linear-gradient(135deg, #3a7bd5, #00d2ff);
}

.profile-icon {
    transition: transform 0.3s ease;
}

.profile-icon:hover {
    transform: scale(1.1);
}

.certificate-card .card {
    transition: all 0.3s ease;
    border-radius: 10px;
}

.certificate-card .card:hover {
    transform: translateY(-5px);
}

.empty-state {
    border: 2px dashed #dee2e6;
}

.badge {
    font-weight: 500;
    padding: 0.35em 0.65em;
}

.bg-success {
    background-color: #28a745 !important;
}

.bg-info {
    background-color: #17a2b8 !important;
}

.bg-warning {
    background-color: #ffc107 !important;
    color: #212529;
}

/* Info Section Styles */
.info-card {
    transition: all 0.3s ease;
    background-color: white;
}

.info-icon {
    width: 40px;
    height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
}

.info-section h5 {
    font-weight: 600;
    color: #343a40;
}

.info-section p {
    font-size: 0.9rem;
}
</style>
{% endblock %}